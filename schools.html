--- 
layout: default 
---

{% assign schools = site.data.schools %}

<style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }

</style>

<div id="map"></div>
<script async defer
src="https://maps.googleapis.com/maps/api/js?key={{ google_maps_js_key }}&callback=initMap">
</script>
<script>

    function initMap() {
        var myLatLng = {lat: 40.5008186, lng: -74.44739909999998};

        var map = new google.maps.Map(document.getElementById('map'), {
            zoom: 8.5,
            center: myLatLng
        });

        var marker = new google.maps.Marker({
            position: myLatLng,
            map: map
        });

        var geocoder = new google.maps.Geocoder;
        var infowindow = new google.maps.InfoWindow;
        
        schools = [
            {% for school in schools %} 
                {
                    name: '{{ school.name }}',
                    placeId: '{{ school.placeId }}'
                },
            {% endfor %}
        ]

        for (var i in schools) {
            console.log(i)
            addMarker(geocoder, map, schools[i].placeId)
        }
    }

    // This function is called when the user clicks the UI button requesting
    // a geocode of a place ID.
    function addMarker(geocoder, map, placeId) {
        // var placeId = document.getElementById('place-id').value;
        geocoder.geocode({'placeId': placeId}, function(results, status) {
            if (status === 'OK') {
                if (results[0]) {
                    latlng = {lat: results[0].geometry.location.lat(), lng: results[0].geometry.location.lng()}
                    new google.maps.Marker({
                        position: latlng,
                        map: map
                    });
                }
            }
        });
    }
</script>

<p> 
    {% for school in schools %} 
        <p>{{ school }}</p>
    {% endfor %}
</p>

